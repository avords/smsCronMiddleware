<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta content="" name="description" />
    <meta content="" name="author" />
    <title>ep6.0</title>
    <!-- common css -->
    <link rel="stylesheet" href="${dynamicDomain}/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="${dynamicDomain}/static/css/main.css">
    <link rel="stylesheet" href="${dynamicDomain}/static/css/ep-icon.css">
    <!-- page css (根据页面需要进行增加)-->
    <link rel="stylesheet" href="${dynamicDomain}/static/css/financeportal.css">
</head>

<body>
    <div class="header">
        <div class="cw">
            <div class="pull-left">
                <div class="header-inner">
                    <div class="logo inline"> <img src="${dynamicDomain}/static/img/logo.png" alt="logo"> </div>
                    <h1 class="logo-text inline"> 一信通企业信息管理平台 <span class="sub-logo"> <img src="" alt="logo"> <span class="text">金融行业中间件应用中心</span> </span> </h1>
                </div>
            </div>
<!--             <div class="pull-right"> -->
<!--                 <div class="profile"> -->
<!--                     <div class="btn-group"> -->
<!--                         <button type="button" class="profile-dropdown-toggle dropdown-toggle" data-toggle="dropdown"> xxx <span class="c-white"> 欢迎您！ <i class="ep ep-arrow-down"></i> </span> </button> -->
<!--                         <div class="dropdown-menu profile-dropdown"> -->
<!--                             <div class="user-infor"> <img src="${dynamicDomain}/static/img/user.png" class="figure pull-left" height="60" width="60" alt=""> -->
<!--                                 <div class="details"> -->
<!--                                     <p>周启航的演示账号</p> -->
<!--                                     <p>123456789 <a href="#" class="pull-right">切换企业</a></p> -->
<!--                                 </div> -->
<!--                                 <div class="links clearfix"> <a href="#">账户中心</a> <a href="#" class="text-center">账务中心</a> <a href="#" class="text-right">退出</a> </div> -->
<!--                             </div> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
        </div>
    </div>
    <div class="navigation">
        <div class="cw">
            <ul class="nav-cont">
                <li> 
                	<a href="#" class="hover">工作台</a> 
<!--                 	<a href="#" class="hover">工作台工台</a>  -->
<!--                 	<a href="#">工作台工作台</a>  -->
                </li>
            </ul>
        </div>
    </div>
    <div class="content">
        <div class="cw">
            <div class="pos p-t-20 p-b-5"> 您当前的位置：<a href="#">中间件配置台</a>&gt;&gt;<a href="#">数据库配置</a> </div>
            <div class="wrap">
                <!--如果没有左侧side，这里增加no-side类即可 -->
                <div class="side pull-left">
                    <div class="side-inner">
                        <ul>
                            <li>
                                <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/index';"><i class="ep ep-side-hide"></i>后台配置首页</a></h3>
                            </li>
<!--                             <li> -->
<!--                                 <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/environmentCheck';"><i class="ep ep-side-hide"></i>环境检测</a></h3> -->
<!--                             </li> -->
                            <li>
                                <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/fileCheck';"><i class="ep ep-side-hide"></i>文件权限检测</a></h3>
                            </li>
                            <li class="hover">
                                <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/databaseConfig';"><i class="ep ep-side-hide"></i>数据库配置</a></h3>
                            </li>
                            <li>
                                <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/interfaceConfig';"><i class="ep ep-side-hide"></i>接口配置</a></h3>
                            </li>
                            <li>
                                <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/columnUpdate';"><i class="ep ep-side-hide"></i>数据库字段名更改</a></h3>
                            </li>
                            <li>
                                <h3><a href="javascript:window.location.href='${dynamicDomain}/backstage/introduction';"><i class="ep ep-side-hide"></i>升级说明</a></h3>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="main-wrap">
                	<form id="databaseForm" action="${dynamicDomain}/backstage/saveDb" method="post">
                    <div class="main">
                        <h2 class=" border-left-width border-left-solid bd-primary m-b-10 large-text p-l-10">数据库配置</h2>
                        <div class="infolabel m-tab">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label for="dbUrl" class=" control-label text-left  pull-left w-100">数据库地址：</label>
                                    <div class="col pull-left">
                                        <input value="${message.getDbUrl()}" type="text" class="form-control w-400" name="dbUrl" id="dbUrl" placeholder="">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="dbDriver" class="control-label text-left pull-left w-100">数据库驱动：</label>
                                    <div class="col pull-left">
                                        <input value="${message.getDbDriver()}" type="text" class="form-control w-400" name="dbDriver" id="dbDriver" placeholder="">
                                    </div>
                                </div>
<!--                                 <div class="form-group"> -->
<!--                                     <label for="dbName" class="control-label text-left pull-left w-100">数据库名：</label> -->
<!--                                     <div class="col pull-left"> -->
<!--                                         <input value="${message.getDbName()}" type="text" class="form-control w-400" name="dbName" id="dbName" placeholder=""> -->
<!--                                     </div> -->
<!--                                 </div> -->
                                <div class="form-group">
                                    <label for="dbUser" class="control-label text-left pull-left w-100">用户名：</label>
                                    <div class="col pull-left">
                                        <input value="${message.getDbUser()}" type="text" class="form-control w-400" name="dbUser" id="dbUser" placeholder="">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="dbPasswd" class="control-label text-left pull-left w-100">密码：</label>
                                    <div class="col pull-left">
                                        <input value="${message.getDbPasswd()}" type="password" class="form-control w-400" name="dbPasswd" id="dbPasswd" placeholder="">
                                    </div>
                                </div>
                            </div>
                        </div>
                
                    <div class="clearfix">
                        
                     
                        <div class="pull-left text-center w-600 p-t-20 ">
                            <button onclick="javascript:return dbCheck();" type="button" class="btn btn-cons btn-primary m-r-10">保存</button>
                        </div>
                    </div>
                </div>
            		</form>
            </div>
        </div>
    </div>
    </div>
    <div class="footer-nav">
        <dl class="about">
            <!-- <dt>关于我们</dt>
    <dd>· <a href="http://www.flaginfo.com.cn/list-107-1.html" target="_blank">关于一信通</a></dd>
    <dd>· <a href="http://www.flaginfo.com.cn/list-112-1.html" target="_blank">方案与服务</a></dd>
    <dd>· <a href="http://www.flaginfo.com.cn/list-99-1.html" target="_blank">经典案例 </a></dd> -->
            <dt>关于我们</dt>
            <dd class="introduce">
                一信通是致力于企业信息移动化服务、专注于移动互联网提供端到端解决方案的信息服务平台
            </dd>
        </dl>
        <dl class="down pos_rel">
            <div class="qq">
                <a href="javascript:openQQWebchat();">
                    <img border="0" src="http://wpa.qq.com/imgd?IDKEY=6032d238acf264090340e5ce47ad6d53fec05ee6cc805bec&amp;pic=51" alt="点击这里给我发消息" title="点击这里给我发消息"></a>
            </div>
            <dt>联系我们</dt>
            <dd>客户服务（工作日 9:00-19:00）</dd>
            <dd>企业QQ：4000806909</dd>
            <dd>电话：400-696-6677</dd>
            <dd>
                <!--  <a href="http://www.flaginfo.com.cn/list-109-1.html" target="_blank">更多联系方式</a> -->
            </dd>
        </dl>
        <dl>
            <dt>商务合作</dt>
            <dd>商务合作（工作日 9:00-19:00）</dd>
            <dd>合作咨询当地联通集客经理</dd>
            <!-- <dd>QQ：422465987</dd> -->
            <dd>
                <!--     电话：021-50806677转260 -->
            </dd>
            <dd>
                <!--     邮件: longjiao.hu@flaginfo.com.cn  -->
                <!-- <a href="#">邮件: longjiao.hu@flaginfo.com.cn</a> -->
            </dd>
        </dl>
        <!-- <dl>
            <dt>e兆社区</dt>
            <dd>
                <span class="dropupmenucom upmenubox popupParentEl">
           <span class="trigger icontrigger"><img src="http://res.ums86.com/5/0/static/images/weixin_zhixun.png"></span>
                <div class="menuwrap popupEl" style="display: none;">
                    <span class="arrow left45"></span>
                    <div class="menucontent">
                        <div class="droptext">
                            <img src="http://res.ums86.com/5/0/static/images/weixin2_zhixun.png">
                        </div>
                    </div>
                </div>
                </span>
            </dd>
            <dd>沪ICP备10032707号</dd>
        </dl> -->
    </div>
    <!--vendor js -->
    <script src="${dynamicDomain}/static/js/jquery-1.11.3.min.js" type="text/javascript"></script>
    <script src="${dynamicDomain}/static/js/bootstrap.js" type="text/javascript"></script>
    <script src="${dynamicDomain}/static/js/ep6.js"></script>
    
<script>
function dbCheck() {
	if ($("#dbUrl").val() == "") {
		alert("数据库地址不能为空");
		return false;
	}
	if ($("#dbDriver").val() == "") {
		alert("数据库驱动不能为空");
		return false;
	}
// 	if ($("#dbName").val() == "") {
// 		alert("数据库名不能为空");
// 		return false;
// 	}
	if ($("#dbUser").val() == "") {
		alert("用户名不能为空");
		return false;
	}
	if ($("#dbPasswd").val() == "") {
		alert("密码不能为空");
		return false;
	}
	
	$.ajax({
		  url:"${dynamicDomain}/login/checkDBParameter",
		  type:"post",
		  data:"url=" + $("#dbUrl").val() + "&driver=" + $("#dbDriver").val() 
		  		+ "&username=" + $("#dbUser").val() + "&passwd=" + $("#dbPasswd").val(),
		  success:function(data){
			  if(data.returnCode=="200"){
				  alert("数据库能正常连通，配置有效");
				  $("#databaseForm").submit();
			  }else{
				  alert("配置的相关数据库参数异常，无法连通数据库");
// 				  $("#dbUrl").val("");
// 				  $("#dbDriver").val("");
// 				  $("#dbName").val("");
// 				  $("#dbUser").val("");
// 				  $("#dbPasswd").val("");
// 				  $("#dbUrl").focus();
			  }
		  },
		  error:function(){
			  alert("异常");
		  }
	});
}
</script>

</body>

</html>
